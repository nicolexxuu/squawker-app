{"ast":null,"code":"import _objectWithoutProperties from\"C:/code/web-dev/warbler/warbler-client/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";var _excluded=[\"token\"];import{apiCall,setTokenHeader}from\"../../services/api\";import{SET_CURRENT_USER}from\"../actionTypes\";import{ADD_ERROR,REMOVE_ERROR,removeError,addError}from\"./errors\";export function setCurrentUser(user){console.log(\"setting current user to \"+user);return{type:SET_CURRENT_USER,user:user};};export function setAuthorizationToken(token){setTokenHeader(token);}export function logout(){return function(dispatch){localStorage.clear();setAuthorizationToken(false);dispatch(setCurrentUser({}));};}export function authUser(type,userData){console.log('current userDAta: '+Object.keys(userData));return function(dispatch){return new Promise(function(resolve,reject){return apiCall(\"post\",\"/api/auth/\".concat(type),userData).then(function(_ref){var token=_ref.token,user=_objectWithoutProperties(_ref,_excluded);console.log('posting user: '+user.id);localStorage.setItem(\"jwtToken\",token);setAuthorizationToken(token);dispatch(setCurrentUser(user));dispatch(removeError());resolve();}).catch(function(err){dispatch(addError(err.message));reject();});});};}","map":{"version":3,"names":["apiCall","setTokenHeader","SET_CURRENT_USER","ADD_ERROR","REMOVE_ERROR","removeError","addError","setCurrentUser","user","console","log","type","setAuthorizationToken","token","logout","dispatch","localStorage","clear","authUser","userData","Object","keys","Promise","resolve","reject","concat","then","_ref","_objectWithoutProperties","_excluded","id","setItem","catch","err","message"],"sources":["C:/code/web-dev/warbler/warbler-client/src/store/actions/auth.js"],"sourcesContent":["import { apiCall, setTokenHeader } from \"../../services/api\";\r\nimport { SET_CURRENT_USER } from \"../actionTypes\";\r\nimport { ADD_ERROR, REMOVE_ERROR, removeError, addError } from \"./errors\";\r\n\r\nexport function setCurrentUser(user) {\r\n    console.log(\"setting current user to \" + user);\r\n    return {\r\n        type: SET_CURRENT_USER,\r\n        user\r\n    };\r\n};\r\n\r\nexport function setAuthorizationToken(token) {\r\n    setTokenHeader(token);\r\n}\r\n\r\nexport function logout() {\r\n    return dispatch => {\r\n        localStorage.clear();\r\n        setAuthorizationToken(false);\r\n        dispatch(setCurrentUser({}));\r\n    }\r\n}\r\n\r\nexport function authUser(type, userData) {\r\n    console.log('current userDAta: ' + Object.keys(userData));\r\n    return dispatch => {\r\n        return new Promise((resolve, reject) => {\r\n            return apiCall(\"post\", `/api/auth/${type}`, userData).then(({ token, ...user }) => {\r\n                console.log('posting user: ' + user.id);\r\n                localStorage.setItem(\"jwtToken\", token);\r\n                setAuthorizationToken(token);\r\n                dispatch(setCurrentUser(user));\r\n                dispatch(removeError());\r\n                resolve();\r\n            })\r\n                .catch(err => {\r\n                    dispatch(addError(err.message));\r\n                    reject();\r\n                })\r\n        });\r\n    }\r\n}"],"mappings":"wKAAA,OAASA,OAAO,CAAEC,cAAc,KAAQ,oBAAoB,CAC5D,OAASC,gBAAgB,KAAQ,gBAAgB,CACjD,OAASC,SAAS,CAAEC,YAAY,CAAEC,WAAW,CAAEC,QAAQ,KAAQ,UAAU,CAEzE,MAAO,SAAS,CAAAC,cAAcA,CAACC,IAAI,CAAE,CACjCC,OAAO,CAACC,GAAG,CAAC,0BAA0B,CAAGF,IAAI,CAAC,CAC9C,MAAO,CACHG,IAAI,CAAET,gBAAgB,CACtBM,IAAI,CAAJA,IACJ,CAAC,CACL,CAAC,CAED,MAAO,SAAS,CAAAI,qBAAqBA,CAACC,KAAK,CAAE,CACzCZ,cAAc,CAACY,KAAK,CAAC,CACzB,CAEA,MAAO,SAAS,CAAAC,MAAMA,CAAA,CAAG,CACrB,MAAO,UAAAC,QAAQ,CAAI,CACfC,YAAY,CAACC,KAAK,EAAE,CACpBL,qBAAqB,CAAC,KAAK,CAAC,CAC5BG,QAAQ,CAACR,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,CAChC,CAAC,CACL,CAEA,MAAO,SAAS,CAAAW,QAAQA,CAACP,IAAI,CAAEQ,QAAQ,CAAE,CACrCV,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAGU,MAAM,CAACC,IAAI,CAACF,QAAQ,CAAC,CAAC,CACzD,MAAO,UAAAJ,QAAQ,CAAI,CACf,MAAO,IAAI,CAAAO,OAAO,CAAC,SAACC,OAAO,CAAEC,MAAM,CAAK,CACpC,MAAO,CAAAxB,OAAO,CAAC,MAAM,cAAAyB,MAAA,CAAed,IAAI,EAAIQ,QAAQ,CAAC,CAACO,IAAI,CAAC,SAAAC,IAAA,CAAwB,IAArB,CAAAd,KAAK,CAAAc,IAAA,CAALd,KAAK,CAAKL,IAAI,CAAAoB,wBAAA,CAAAD,IAAA,CAAAE,SAAA,EACxEpB,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAGF,IAAI,CAACsB,EAAE,CAAC,CACvCd,YAAY,CAACe,OAAO,CAAC,UAAU,CAAElB,KAAK,CAAC,CACvCD,qBAAqB,CAACC,KAAK,CAAC,CAC5BE,QAAQ,CAACR,cAAc,CAACC,IAAI,CAAC,CAAC,CAC9BO,QAAQ,CAACV,WAAW,EAAE,CAAC,CACvBkB,OAAO,EAAE,CACb,CAAC,CAAC,CACGS,KAAK,CAAC,SAAAC,GAAG,CAAI,CACVlB,QAAQ,CAACT,QAAQ,CAAC2B,GAAG,CAACC,OAAO,CAAC,CAAC,CAC/BV,MAAM,EAAE,CACZ,CAAC,CAAC,CACV,CAAC,CAAC,CACN,CAAC,CACL"},"metadata":{},"sourceType":"module","externalDependencies":[]}