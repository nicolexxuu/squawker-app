{"ast":null,"code":"import { apiCall, setTokenHeader } from \"../../services/api\";\nimport { SET_CURRENT_USER } from \"../actionTypes\";\nimport { ADD_ERROR, REMOVE_ERROR, removeError, addError } from \"./errors\";\nexport function setCurrentUser(user) {\n  console.log(\"setting current user to \" + user.id);\n  return {\n    type: SET_CURRENT_USER,\n    user\n  };\n}\n;\nexport function setAuthorizationToken(token) {\n  setTokenHeader(token);\n}\nexport function logout() {\n  return dispatch => {\n    localStorage.clear();\n    setAuthorizationToken(false);\n    dispatch(setCurrentUser({}));\n  };\n}\nexport function authUser(type, userData) {\n  return dispatch => {\n    return new Promise((resolve, reject) => {\n      return apiCall(\"post\", `/api/auth/${type}`, userData).then(_ref => {\n        let {\n          token,\n          ...user\n        } = _ref;\n        console.log('posting user: ' + Object.keys(user));\n        localStorage.setItem(\"jwtToken\", token);\n        setAuthorizationToken(token);\n        dispatch(setCurrentUser(user));\n        dispatch(removeError());\n        resolve();\n      }).catch(err => {\n        dispatch(addError(err.message));\n        reject();\n      });\n    });\n  };\n}","map":{"version":3,"names":["apiCall","setTokenHeader","SET_CURRENT_USER","ADD_ERROR","REMOVE_ERROR","removeError","addError","setCurrentUser","user","console","log","id","type","setAuthorizationToken","token","logout","dispatch","localStorage","clear","authUser","userData","Promise","resolve","reject","then","_ref","Object","keys","setItem","catch","err","message"],"sources":["C:/code/web-dev/warbler/warbler-client/src/store/actions/auth.js"],"sourcesContent":["import { apiCall, setTokenHeader } from \"../../services/api\";\r\nimport { SET_CURRENT_USER } from \"../actionTypes\";\r\nimport { ADD_ERROR, REMOVE_ERROR, removeError, addError } from \"./errors\";\r\n\r\nexport function setCurrentUser(user) {\r\n    console.log(\"setting current user to \" + user.id);\r\n    return {\r\n        type: SET_CURRENT_USER,\r\n        user\r\n    };\r\n};\r\n\r\nexport function setAuthorizationToken(token) {\r\n    setTokenHeader(token);\r\n}\r\n\r\nexport function logout() {\r\n    return dispatch => {\r\n        localStorage.clear();\r\n        setAuthorizationToken(false);\r\n        dispatch(setCurrentUser({}));\r\n    }\r\n}\r\n\r\nexport function authUser(type, userData) {\r\n    return dispatch => {\r\n        return new Promise((resolve, reject) => {\r\n            return apiCall(\"post\", `/api/auth/${type}`, userData).then(({ token, ...user }) => {\r\n                console.log('posting user: ' + Object.keys(user));\r\n                localStorage.setItem(\"jwtToken\", token);\r\n                setAuthorizationToken(token);\r\n                dispatch(setCurrentUser(user));\r\n                dispatch(removeError());\r\n                resolve();\r\n            })\r\n                .catch(err => {\r\n                    dispatch(addError(err.message));\r\n                    reject();\r\n                })\r\n        });\r\n    }\r\n}"],"mappings":"AAAA,SAASA,OAAO,EAAEC,cAAc,QAAQ,oBAAoB;AAC5D,SAASC,gBAAgB,QAAQ,gBAAgB;AACjD,SAASC,SAAS,EAAEC,YAAY,EAAEC,WAAW,EAAEC,QAAQ,QAAQ,UAAU;AAEzE,OAAO,SAASC,cAAcA,CAACC,IAAI,EAAE;EACjCC,OAAO,CAACC,GAAG,CAAC,0BAA0B,GAAGF,IAAI,CAACG,EAAE,CAAC;EACjD,OAAO;IACHC,IAAI,EAAEV,gBAAgB;IACtBM;EACJ,CAAC;AACL;AAAC;AAED,OAAO,SAASK,qBAAqBA,CAACC,KAAK,EAAE;EACzCb,cAAc,CAACa,KAAK,CAAC;AACzB;AAEA,OAAO,SAASC,MAAMA,CAAA,EAAG;EACrB,OAAOC,QAAQ,IAAI;IACfC,YAAY,CAACC,KAAK,EAAE;IACpBL,qBAAqB,CAAC,KAAK,CAAC;IAC5BG,QAAQ,CAACT,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC;EAChC,CAAC;AACL;AAEA,OAAO,SAASY,QAAQA,CAACP,IAAI,EAAEQ,QAAQ,EAAE;EACrC,OAAOJ,QAAQ,IAAI;IACf,OAAO,IAAIK,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACpC,OAAOvB,OAAO,CAAC,MAAM,EAAG,aAAYY,IAAK,EAAC,EAAEQ,QAAQ,CAAC,CAACI,IAAI,CAACC,IAAA,IAAwB;QAAA,IAAvB;UAAEX,KAAK;UAAE,GAAGN;QAAK,CAAC,GAAAiB,IAAA;QAC1EhB,OAAO,CAACC,GAAG,CAAC,gBAAgB,GAAGgB,MAAM,CAACC,IAAI,CAACnB,IAAI,CAAC,CAAC;QACjDS,YAAY,CAACW,OAAO,CAAC,UAAU,EAAEd,KAAK,CAAC;QACvCD,qBAAqB,CAACC,KAAK,CAAC;QAC5BE,QAAQ,CAACT,cAAc,CAACC,IAAI,CAAC,CAAC;QAC9BQ,QAAQ,CAACX,WAAW,EAAE,CAAC;QACvBiB,OAAO,EAAE;MACb,CAAC,CAAC,CACGO,KAAK,CAACC,GAAG,IAAI;QACVd,QAAQ,CAACV,QAAQ,CAACwB,GAAG,CAACC,OAAO,CAAC,CAAC;QAC/BR,MAAM,EAAE;MACZ,CAAC,CAAC;IACV,CAAC,CAAC;EACN,CAAC;AACL"},"metadata":{},"sourceType":"module","externalDependencies":[]}